<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÄ‡∏Å‡∏°‡∏™‡πå‡∏ö‡∏ß‡∏Å‡πÄ‡∏•‡∏Ç - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡πâ‡∏≠‡∏á‡πÜ ‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Kanit', Arial, sans-serif;
            background: linear-gradient(135deg, #ff9a9e, #fecfef, #fecfef);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            padding: 30px;
            max-width: 600px;
            width: 100%;
            text-align: center;
        }

        h1 {
            color: #ff6b6b;
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .level-selection {
            margin-bottom: 30px;
        }

        .level-btn {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
            border: none;
            padding: 15px 25px;
            margin: 10px;
            border-radius: 15px;
            font-size: 1.2em;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .level-btn:hover {
            transform: scale(1.05);
        }

        .level-btn.active {
            background: linear-gradient(45deg, #ff6b6b, #ee5a6f);
        }

        .game-area {
            display: none;
        }

        .question {
            font-size: 3em;
            color: #333;
            margin: 30px 0;
            font-weight: bold;
        }

        .progress {
            background: #e0e0e0;
            height: 20px;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
        }

        .answer-input {
            font-size: 2em;
            padding: 15px;
            border: 3px solid #ddd;
            border-radius: 15px;
            width: 200px;
            text-align: center;
            margin: 20px;
        }

        .answer-input:focus {
            border-color: #4ecdc4;
            outline: none;
        }

        .submit-btn {
            background: linear-gradient(45deg, #ffa726, #fb8c00);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 15px;
            font-size: 1.5em;
            cursor: pointer;
            margin: 20px;
            transition: transform 0.2s;
        }

        .submit-btn:hover {
            transform: scale(1.05);
        }

        .feedback {
            font-size: 1.5em;
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
        }

        .correct {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }

        .incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }

        .results {
            display: none;
            margin-top: 30px;
        }

        .score {
            font-size: 2em;
            color: #4ecdc4;
            margin: 20px 0;
        }

        .history {
            display: none;
            margin-top: 30px;
        }

        .history-item {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            border-left: 5px solid #4ecdc4;
        }

        .nav-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            margin: 10px;
            transition: transform 0.2s;
        }

        .nav-btn:hover {
            transform: scale(1.05);
        }

        .emoji {
            font-size: 2em;
            margin: 0 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üßÆ ‡πÄ‡∏Å‡∏°‡∏™‡πå‡∏ö‡∏ß‡∏Å‡πÄ‡∏•‡∏Ç üåü</h1>
        
        <!-- ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö -->
        <div id="level-screen">
            <div class="level-selection">
                <h2>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å</h2>
                <button class="level-btn" data-level="1">‡∏á‡πà‡∏≤‡∏¢ (1-10)</button>
                <button class="level-btn" data-level="2">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á (1-20)</button>
                <button class="level-btn" data-level="3">‡∏¢‡∏≤‡∏Å (1-50)</button>
            </div>
            <button class="nav-btn" onclick="showHistory()">üìä ‡∏î‡∏π‡∏ú‡∏•‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á</button>
        </div>

        <!-- ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡∏° -->
        <div id="game-screen" class="game-area">
            <div class="progress">
                <div class="progress-bar" id="progress"></div>
            </div>
            <div>‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà <span id="current-question">1</span> / 10</div>
            
            <div class="question" id="question"></div>
            
            <input type="number" class="answer-input" id="answer" placeholder="‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö">
            <br>
            <button class="submit-btn" onclick="checkAnswer()">‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
            
            <div id="feedback" class="feedback" style="display: none;"></div>
        </div>

        <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå -->
        <div id="results-screen" class="results">
            <h2>üéâ ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß! üéâ</h2>
            <div class="score" id="final-score"></div>
            <button class="nav-btn" onclick="restartGame()">üîÑ ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
            <button class="nav-btn" onclick="backToLevelSelection()">üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
        </div>

        <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ -->
        <div id="history-screen" class="history">
            <h2>üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á</h2>
            <div id="history-list"></div>
            <button class="nav-btn" onclick="backToLevelSelection()">üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
            <button class="nav-btn" onclick="clearHistory()">üóëÔ∏è ‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>
        </div>
    </div>

    <script>
        let currentLevel = 1;
        let questions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let gameHistory = JSON.parse(localStorage.getItem('mathGameHistory')) || [];

        // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å
        document.querySelectorAll('.level-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentLevel = parseInt(this.dataset.level);
                setTimeout(() => startGame(), 500);
            });
        });

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
        function startGame() {
            document.getElementById('level-screen').style.display = 'none';
            document.getElementById('game-screen').style.display = 'block';
            document.getElementById('results-screen').style.display = 'none';
            document.getElementById('history-screen').style.display = 'none';
            
            generateQuestions();
            currentQuestionIndex = 0;
            score = 0;
            showQuestion();
        }

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå
        function generateQuestions() {
            questions = [];
            let maxNum;
            
            switch(currentLevel) {
                case 1: maxNum = 10; break;
                case 2: maxNum = 20; break;
                case 3: maxNum = 50; break;
            }
            
            for(let i = 0; i < 10; i++) {
                let num1 = Math.floor(Math.random() * maxNum) + 1;
                let num2 = Math.floor(Math.random() * maxNum) + 1;
                questions.push({
                    num1: num1,
                    num2: num2,
                    answer: num1 + num2
                });
            }
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå
        function showQuestion() {
            if(currentQuestionIndex >= 10) {
                showResults();
                return;
            }
            
            const question = questions[currentQuestionIndex];
            document.getElementById('question').textContent = `${question.num1} + ${question.num2} = ?`;
            document.getElementById('current-question').textContent = currentQuestionIndex + 1;
            document.getElementById('answer').value = '';
            document.getElementById('feedback').style.display = 'none';
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏ñ‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤
            const progress = ((currentQuestionIndex) / 10) * 100;
            document.getElementById('progress').style.width = progress + '%';
            
            document.getElementById('answer').focus();
        }

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
        function checkAnswer() {
            const userAnswer = parseInt(document.getElementById('answer').value);
            const correctAnswer = questions[currentQuestionIndex].answer;
            const feedbackDiv = document.getElementById('feedback');
            
            if(isNaN(userAnswer)) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç');
                return;
            }
            
            feedbackDiv.style.display = 'block';
            
            if(userAnswer === correctAnswer) {
                score++;
                feedbackDiv.className = 'feedback correct';
                feedbackDiv.innerHTML = 'üéâ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å!';
                setTimeout(() => {
                    currentQuestionIndex++;
                    showQuestion();
                }, 1500);
            } else {
                feedbackDiv.className = 'feedback incorrect';
                feedbackDiv.innerHTML = `‚ùå ‡∏ú‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏à‡πâ‡∏≤ ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏≠ ${correctAnswer}`;
                setTimeout(() => {
                    currentQuestionIndex++;
                    showQuestion();
                }, 2500);
            }
        }

        // ‡∏Å‡∏î Enter ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
        document.getElementById('answer').addEventListener('keypress', function(e) {
            if(e.key === 'Enter') {
                checkAnswer();
            }
        });

        // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
        function showResults() {
            document.getElementById('game-screen').style.display = 'none';
            document.getElementById('results-screen').style.display = 'block';
            
            const percentage = (score / 10) * 100;
            let message = '';
            
            if(percentage >= 90) message = 'üåü ‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°!';
            else if(percentage >= 70) message = 'üëè ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å!';
            else if(percentage >= 50) message = 'üòä ‡∏î‡∏µ‡πÅ‡∏•‡πâ‡∏ß!';
            else message = 'üí™ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞!';
            
            document.getElementById('final-score').innerHTML = 
                `${message}<br>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${score}/10 (${percentage}%)`;
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
            const levelNames = ['', '‡∏á‡πà‡∏≤‡∏¢', '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á', '‡∏¢‡∏≤‡∏Å'];
            gameHistory.unshift({
                date: new Date().toLocaleDateString('th-TH'),
                time: new Date().toLocaleTimeString('th-TH'),
                level: levelNames[currentLevel],
                score: score,
                total: 10,
                percentage: percentage
            });
            
            // ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞ 20 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
            if(gameHistory.length > 20) {
                gameHistory = gameHistory.slice(0, 20);
            }
            
            localStorage.setItem('mathGameHistory', JSON.stringify(gameHistory));
        }

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà
        function restartGame() {
            startGame();
        }

        // ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö
        function backToLevelSelection() {
            document.getElementById('level-screen').style.display = 'block';
            document.getElementById('game-screen').style.display = 'none';
            document.getElementById('results-screen').style.display = 'none';
            document.getElementById('history-screen').style.display = 'none';
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
        function showHistory() {
            document.getElementById('level-screen').style.display = 'none';
            document.getElementById('history-screen').style.display = 'block';
            
            const historyList = document.getElementById('history-list');
            
            if(gameHistory.length === 0) {
                historyList.innerHTML = '<p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô</p>';
                return;
            }
            
            historyList.innerHTML = gameHistory.map((game, index) => 
                `<div class="history-item">
                    <strong>‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà ${index + 1}</strong> - ${game.date} ${game.time}<br>
                    ‡∏£‡∏∞‡∏î‡∏±‡∏ö: ${game.level} | ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${game.score}/${game.total} (${game.percentage}%)
                </div>`
            ).join('');
        }

        // ‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
        function clearHistory() {
            if(confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                gameHistory = [];
                localStorage.removeItem('mathGameHistory');
                showHistory();
            }
        }
    </script>
</body>
</html>
